@using Microsoft.SemanticKernel
@using Microsoft.SemanticKernel.ChatCompletion
@using Microsoft.SemanticKernel.Connectors.OpenAI
@using System.Text
@using Open.Blazor.Ui.Features.Shared.Models
@inject IJSRuntime JsRuntime
@if (_discourse is not null && _activeOllamaModels is not null)
{
    
    <FluentStack Orientation="Orientation.Horizontal"
                 HorizontalAlignment="HorizontalAlignment.Start">
        <FluentSelect TOption="OllamaModel"
                      Label="Select a model"
                      Items="@_activeOllamaModels.Models"
                      Id="listOfActiveModels"
                      Width="200px"
                      OptionText="@(p => p.Name)"
                      SelectedOption="_selectedModel"
                      SelectedOptionChanged="HandleSelectedOptionChanged" />
    </FluentStack>
    <div id="chat-window">

        @foreach (var message in _discourse.ChatMessages)
        {
            <ChatContent Message="message" />
        }

    </div>
    <div class="chat-box-container">
        <FluentTextArea @bind-Value=_userMessage Style="width:700px" Placeholder="Let's chat"></FluentTextArea>

        @if (!_isChatOngoing)
        {
            <FluentButton IconStart="@(new Icons.Filled.Size16.Send())" Style="margin-left:5px"
                          Appearance="Appearance.Stealth" OnClick="SendMessage" />
        }
        else
        {
            <FluentButton IconStart="@(new Icons.Filled.Size16.Stop())" Style="margin-left:5px"
                          Appearance="Appearance.Stealth" OnClick="StopChat" />
        }


    </div>

}

